<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">

<link rel="import" href="adventures/adventures-main.html">

<dom-module id="ng-adventures">

    <template>
        <style is="custom-style" include="shared-styles">
            /* CSS rules for your element */

        </style>

        <!-- local DOM for your element -->

        <app-route route="{{route}}" pattern="/:action" data="{{actionData}}" tail="{{tail}}"></app-route>
        <div class="submenu">
            <paper-card>
                <paper-tabs selected="[[actionData.action]]" attr-for-selected="name" noink>
                    <paper-tab name="skating">
                        <a href="/adventures/skating">
                            <span class="hide-on-small-only">Ice skating</span>
                            <span class="hide-on-med-and-up">Skating</span>
                        </a>
                    </paper-tab>
                    <paper-tab name="skiing">
                        <a href="/adventures/skiing">
                            <span class="hide-on-small-only">Cross country skiing</span>
                            <span class="hide-on-med-and-up">Skiing</span>
                        </a>
                    </paper-tab>
                    <paper-tab name="kayak"><a href="/adventures/kayak">Kayak<span class="hidden-xs">ing</span></a></paper-tab>
                    <paper-tab name="hiking"><a href="/adventures/hiking">Hiking</a></paper-tab>
                </paper-tabs>
            </paper-card>
        </div>

        <iron-pages selected="[[actionData.action]]" attr-for-selected="name" fallback-selection="main" role="main">
            <adventures-main name="main"></adventures-main>
            <adventures-skating name="skating"></adventures-skating>
            <adventures-skiing name="skiing"></adventures-skiing>
            <adventures-kayak name="kayak"></adventures-kayak>
            <adventures-hiking name="hiking"></adventures-hiking>
        </iron-pages>

    </template>

    <script>
        // element registration
        Polymer({
          is: "ng-adventures",

          // add properties and methods on the element's prototype

            properties: {
                action: {
                    type: String,
                    reflectToAttribute: true,
                    observer: '_pageChanged',
                },
            },

            observers: [
                '_routePageChanged(actionData.action)',
            ],

            _routePageChanged: function(route) {
                this.action = route || 'main';
            },

            _pageChanged: function(action) {
                // Load page import on demand. Show 404 page if fails
                var myPageToOpen = 'adventures/adventures-' + action + '.html';

                var resolvedPageUrl = this.resolveUrl(myPageToOpen);
                this.importHref(resolvedPageUrl, null, this._showPage404, true);
            },

            _showPage404: function() {
                this.page = 'main';
            },
        });
      </script>

</dom-module>